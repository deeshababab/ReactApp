{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _reactNative = require(\"react-native\");\n\nvar _helpers = require(\"../../helpers\");\n\nvar _style = require(\"../../style\");\n\nvar _commons = require(\"../../commons\");\n\nvar _view = _interopRequireDefault(require(\"../view\"));\n\nvar _touchableOpacity = _interopRequireDefault(require(\"../touchableOpacity\"));\n\nvar _button = _interopRequireDefault(require(\"../button\"));\n\nvar _card = _interopRequireDefault(require(\"../card\"));\n\nvar _jsxFileName = \"E:\\\\react-native-starter-master\\\\react-native-starter-master\\\\node_modules\\\\react-native-ui-lib\\\\src\\\\components\\\\stackAggregator\\\\index.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nvar PEEP = 8;\nvar DURATION = 300;\nvar MARGIN_BOTTOM = 24;\nvar buttonStartValue = 0.8;\n\nvar icon = require('./assets/arrow-down.png');\n\nvar StackAggregator = function (_PureBaseComponent) {\n  (0, _inherits2.default)(StackAggregator, _PureBaseComponent);\n\n  var _super = _createSuper(StackAggregator);\n\n  function StackAggregator(props) {\n    var _this;\n\n    (0, _classCallCheck2.default)(this, StackAggregator);\n    _this = _super.call(this, props);\n\n    _this.animate = function () {\n      _this.animateValues();\n\n      _this.animateCards();\n    };\n\n    _this.close = function () {\n      _this.setState({\n        collapsed: true\n      }, function () {\n        return _this.animate();\n      });\n    };\n\n    _this.open = function () {\n      _this.setState({\n        collapsed: false\n      }, function () {\n        return _this.animate();\n      });\n    };\n\n    _this.onLayout = function (event) {\n      var height = event.nativeEvent.layout.height;\n\n      if (height) {\n        _this.setState({\n          firstItemHeight: height\n        });\n      }\n    };\n\n    _this.onItemPress = function (index) {\n      _lodash.default.invoke(_this.props, 'onItemPress', index);\n    };\n\n    _this.renderItem = function (item, index) {\n      var _this$props = _this.props,\n          contentContainerStyle = _this$props.contentContainerStyle,\n          itemBorderRadius = _this$props.itemBorderRadius;\n      var _this$state = _this.state,\n          firstItemHeight = _this$state.firstItemHeight,\n          collapsed = _this$state.collapsed;\n      return _react.default.createElement(_reactNative.Animated.View, {\n        key: index,\n        onLayout: index === 0 ? _this.onLayout : undefined,\n        style: [_helpers.Constants.isIOS && _this.styles.containerShadow, _this.getStyle(index), {\n          borderRadius: _helpers.Constants.isIOS ? itemBorderRadius : undefined,\n          alignSelf: 'center',\n          zIndex: _this.itemsCount - index,\n          transform: [{\n            scaleX: _this.animatedScaleArray[index]\n          }],\n          width: _helpers.Constants.screenWidth - 40,\n          height: collapsed ? firstItemHeight : undefined\n        }],\n        collapsable: false,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 7\n        }\n      }, _react.default.createElement(_card.default, {\n        style: [contentContainerStyle, _this.styles.card],\n        onPress: function onPress() {\n          return _this.onItemPress(index);\n        },\n        borderRadius: itemBorderRadius,\n        elevation: 5,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 9\n        }\n      }, _react.default.createElement(_reactNative.Animated.View, {\n        style: index !== 0 ? {\n          opacity: _this.animatedContentOpacity\n        } : undefined,\n        collapsable: false,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 11\n        }\n      }, item)));\n    };\n\n    _this.state = {\n      collapsed: props.collapsed,\n      firstItemHeight: undefined\n    };\n    _this.itemsCount = _react.default.Children.count(props.children);\n    _this.easeOut = _reactNative.Easing.bezier(0, 0, 0.58, 1);\n    _this.animatedScale = new _reactNative.Animated.Value(_this.state.collapsed ? buttonStartValue : 1);\n    _this.animatedOpacity = new _reactNative.Animated.Value(_this.state.collapsed ? buttonStartValue : 1);\n    _this.animatedScaleArray = _this.getAnimatedScales();\n    _this.animatedContentOpacity = new _reactNative.Animated.Value(_this.state.collapsed ? 0 : 1);\n    return _this;\n  }\n\n  (0, _createClass2.default)(StackAggregator, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      if (prevState.collapsed !== this.state.collapsed) {\n        _reactNative.LayoutAnimation.configureNext(_reactNative.LayoutAnimation.Presets.easeInEaseOut);\n      }\n    }\n  }, {\n    key: \"generateStyles\",\n    value: function generateStyles() {\n      this.styles = createStyles(this.getThemeProps());\n    }\n  }, {\n    key: \"getAnimatedScales\",\n    value: function getAnimatedScales() {\n      var _this2 = this;\n\n      return _react.default.Children.map(this.props.children, function (item, index) {\n        return new _reactNative.Animated.Value(_this2.getItemScale(index));\n      });\n    }\n  }, {\n    key: \"getItemScale\",\n    value: function getItemScale(index) {\n      if (this.state.collapsed) {\n        if (index === this.itemsCount - 2) {\n          return 0.95;\n        }\n\n        if (index === this.itemsCount - 1) {\n          return 0.90;\n        }\n      }\n\n      return 1;\n    }\n  }, {\n    key: \"animateValues\",\n    value: function animateValues() {\n      var collapsed = this.state.collapsed;\n      var newValue = collapsed ? buttonStartValue : 1;\n\n      _reactNative.Animated.parallel([_reactNative.Animated.timing(this.animatedOpacity, {\n        duration: DURATION,\n        toValue: Number(newValue),\n        useNativeDriver: true\n      }), _reactNative.Animated.timing(this.animatedScale, {\n        toValue: Number(newValue),\n        easing: this.easeOut,\n        duration: DURATION,\n        useNativeDriver: true\n      }), _reactNative.Animated.timing(this.animatedContentOpacity, {\n        toValue: Number(collapsed ? 0 : 1),\n        easing: this.easeOut,\n        duration: DURATION,\n        useNativeDriver: true\n      })]).start();\n    }\n  }, {\n    key: \"animateCards\",\n    value: function animateCards() {\n      for (var index = 0; index < this.itemsCount; index++) {\n        var newScale = this.getItemScale(index);\n\n        _reactNative.Animated.timing(this.animatedScaleArray[index], {\n          toValue: Number(newScale),\n          easing: this.easeOut,\n          duration: DURATION,\n          useNativeDriver: true\n        }).start();\n      }\n    }\n  }, {\n    key: \"getTop\",\n    value: function getTop(index) {\n      var start = 0;\n\n      if (index === this.itemsCount - 2) {\n        start += PEEP;\n      }\n\n      if (index === this.itemsCount - 1) {\n        start += PEEP * 2;\n      }\n\n      return start;\n    }\n  }, {\n    key: \"getStyle\",\n    value: function getStyle(index) {\n      var collapsed = this.state.collapsed;\n      var top = this.getTop(index);\n\n      if (collapsed) {\n        return {\n          position: index !== 0 ? 'absolute' : undefined,\n          top: top\n        };\n      }\n\n      return {\n        marginBottom: MARGIN_BOTTOM,\n        marginTop: index === 0 ? 40 : undefined\n      };\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$props2 = this.props,\n          children = _this$props2.children,\n          containerStyle = _this$props2.containerStyle,\n          buttonProps = _this$props2.buttonProps;\n      var _this$state2 = this.state,\n          collapsed = _this$state2.collapsed,\n          firstItemHeight = _this$state2.firstItemHeight;\n      return _react.default.createElement(_view.default, {\n        style: containerStyle,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 239,\n          columnNumber: 7\n        }\n      }, _react.default.createElement(_view.default, {\n        style: {\n          marginBottom: PEEP * 3\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 9\n        }\n      }, _react.default.createElement(_reactNative.Animated.View, {\n        style: {\n          position: 'absolute',\n          right: 0,\n          opacity: this.animatedOpacity,\n          transform: [{\n            scale: this.animatedScale\n          }]\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 241,\n          columnNumber: 11\n        }\n      }, _react.default.createElement(_button.default, (0, _extends2.default)({\n        label: 'Show less',\n        iconSource: icon,\n        link: true,\n        size: 'small'\n      }, buttonProps, {\n        \"marginH-24\": true,\n        \"marginB-20\": true,\n        onPress: this.close,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 13\n        }\n      }))), _react.default.Children.map(children, function (item, index) {\n        return _this3.renderItem(item, index);\n      }), collapsed && _react.default.createElement(_touchableOpacity.default, {\n        onPress: this.open,\n        activeOpacity: 1,\n        style: [this.styles.touchable, {\n          height: firstItemHeight ? firstItemHeight + PEEP * 2 : undefined,\n          zIndex: this.itemsCount\n        }],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 268,\n          columnNumber: 13\n        }\n      })));\n    }\n  }]);\n  return StackAggregator;\n}(_commons.PureBaseComponent);\n\nexports.default = StackAggregator;\nStackAggregator.displayName = 'StackAggregator';\nStackAggregator.propTypes = {\n  collapsed: _propTypes.default.bool,\n  containerStyle: _propTypes.default.oneOfType([_propTypes.default.object, _propTypes.default.number, _propTypes.default.array]),\n  contentContainerStyle: _propTypes.default.oneOfType([_propTypes.default.object, _propTypes.default.number, _propTypes.default.array]),\n  itemBorderRadius: _propTypes.default.number,\n  buttonProps: _propTypes.default.object,\n  onItemPress: _propTypes.default.func\n};\nStackAggregator.defaultProps = {\n  collapsed: true,\n  itemBorderRadius: 0\n};\n\nfunction createStyles() {\n  return _reactNative.StyleSheet.create({\n    touchable: {\n      position: 'absolute',\n      width: '100%'\n    },\n    containerShadow: {\n      backgroundColor: _style.Colors.white,\n      shadowColor: _style.Colors.dark40,\n      shadowOpacity: 0.25,\n      shadowRadius: 12,\n      shadowOffset: {\n        height: 5,\n        width: 0\n      }\n    },\n    card: {\n      overflow: 'hidden',\n      flexShrink: 1\n    }\n  });\n}","map":{"version":3,"sources":["E:/react-native-starter-master/react-native-starter-master/node_modules/react-native-ui-lib/src/components/stackAggregator/index.js"],"names":["PEEP","DURATION","MARGIN_BOTTOM","buttonStartValue","icon","require","StackAggregator","props","animate","animateValues","animateCards","close","setState","collapsed","open","onLayout","event","height","nativeEvent","layout","firstItemHeight","onItemPress","index","_","invoke","renderItem","item","contentContainerStyle","itemBorderRadius","state","undefined","Constants","isIOS","styles","containerShadow","getStyle","borderRadius","alignSelf","zIndex","itemsCount","transform","scaleX","animatedScaleArray","width","screenWidth","card","opacity","animatedContentOpacity","React","Children","count","children","easeOut","Easing","bezier","animatedScale","Animated","Value","animatedOpacity","getAnimatedScales","prevProps","prevState","LayoutAnimation","configureNext","Presets","easeInEaseOut","createStyles","getThemeProps","map","getItemScale","newValue","parallel","timing","duration","toValue","Number","useNativeDriver","easing","start","newScale","top","getTop","position","marginBottom","marginTop","containerStyle","buttonProps","right","scale","touchable","PureBaseComponent","displayName","propTypes","PropTypes","bool","oneOfType","object","number","array","func","defaultProps","StyleSheet","create","backgroundColor","Colors","white","shadowColor","dark40","shadowOpacity","shadowRadius","shadowOffset","overflow","flexShrink"],"mappings":"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","sourcesContent":["import _ from 'lodash';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {StyleSheet, Animated, Easing, LayoutAnimation} from 'react-native';\nimport {Constants} from '../../helpers';\nimport {Colors} from '../../style';\nimport {PureBaseComponent} from '../../commons';\nimport View from '../view';\nimport TouchableOpacity from '../touchableOpacity';\nimport Button from '../button';\nimport Card from '../card';\n\n\nconst PEEP = 8;\nconst DURATION = 300;\nconst MARGIN_BOTTOM = 24;\nconst buttonStartValue = 0.8;\nconst icon = require('./assets/arrow-down.png');\n\n/**\n * @description: Stack aggregator component\n * @modifiers: margin, padding\n * @example: https://github.com/wix/react-native-ui-lib/blob/feat/StackAggregator/demo/src/screens/componentScreens/StackAggregatorScreen.js\n */\nexport default class StackAggregator extends PureBaseComponent {\n  static displayName = 'StackAggregator';\n\n  static propTypes = {\n    /**\n     * The initial state of the stack\n     */\n    collapsed: PropTypes.bool,\n    /**\n     * The container style\n     */\n    containerStyle: PropTypes.oneOfType([PropTypes.object, PropTypes.number, PropTypes.array]),\n    /**\n     * The content container style\n     */\n    contentContainerStyle: PropTypes.oneOfType([PropTypes.object, PropTypes.number, PropTypes.array]),\n    /**\n     * The items border radius\n     */\n    itemBorderRadius: PropTypes.number,\n    /**\n     * Props passed to the 'show less' button\n     */\n    buttonProps: PropTypes.object,\n    /**\n     * A callback for item press\n     */\n    onItemPress: PropTypes.func\n  }\n\n  static defaultProps = {\n    collapsed: true,\n    itemBorderRadius: 0\n  }\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      collapsed: props.collapsed,\n      firstItemHeight: undefined\n    };\n\n    this.itemsCount = React.Children.count(props.children);\n    this.easeOut = Easing.bezier(0, 0, 0.58, 1);\n    this.animatedScale = new Animated.Value(this.state.collapsed ? buttonStartValue : 1);\n    this.animatedOpacity = new Animated.Value(this.state.collapsed ? buttonStartValue : 1);\n    this.animatedScaleArray = this.getAnimatedScales();\n    this.animatedContentOpacity = new Animated.Value(this.state.collapsed ? 0 : 1);\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevState.collapsed !== this.state.collapsed) {\n      LayoutAnimation.configureNext(LayoutAnimation.Presets.easeInEaseOut);\n    }\n  }\n\n  generateStyles() {\n    this.styles = createStyles(this.getThemeProps());\n  }\n\n  getAnimatedScales() {\n    return React.Children.map(this.props.children, (item, index) => {\n      return new Animated.Value(this.getItemScale(index));\n    });\n  }\n\n  getItemScale(index) {\n    if (this.state.collapsed) {\n      if (index === this.itemsCount - 2) {\n        return 0.95;\n      }\n      if (index === this.itemsCount - 1) {\n        return 0.90;\n      }\n    }\n    return 1;\n  }\n\n  animate = () => {\n    this.animateValues();\n    this.animateCards();\n  }\n\n  animateValues() {\n    const {collapsed} = this.state;\n    const newValue = collapsed ? buttonStartValue : 1;\n\n    Animated.parallel([\n      Animated.timing(this.animatedOpacity, {\n        duration: DURATION,\n        toValue: Number(newValue),\n        useNativeDriver: true\n      }),\n      Animated.timing(this.animatedScale, {\n        toValue: Number(newValue),\n        easing: this.easeOut,\n        duration: DURATION,\n        useNativeDriver: true\n      }),\n      Animated.timing(this.animatedContentOpacity, {\n        toValue: Number(collapsed ? 0 : 1),\n        easing: this.easeOut,\n        duration: DURATION,\n        useNativeDriver: true\n      })\n    ]).start();\n  }\n\n  animateCards() {    \n    for (let index = 0; index < this.itemsCount; index++) {\n      const newScale = this.getItemScale(index);\n\n      Animated.timing(this.animatedScaleArray[index], {\n        toValue: Number(newScale),\n        easing: this.easeOut,\n        duration: DURATION,\n        useNativeDriver: true\n      }).start();\n    }\n  }\n\n  close = () => {\n    this.setState({collapsed: true}, () => this.animate());\n  }\n\n  open = () => {\n    this.setState({collapsed: false}, () => this.animate());\n  }\n\n  getTop(index) {\n    let start = 0;\n    \n    if (index === this.itemsCount - 2) {\n      start += PEEP;\n    }\n    if (index === this.itemsCount - 1) {\n      start += (PEEP * 2);\n    }\n\n    return start;\n  }\n\n  getStyle(index) {\n    const {collapsed} = this.state;\n    const top = this.getTop(index);\n    \n    if (collapsed) {\n      return {\n        position: index !== 0 ? 'absolute' : undefined, \n        top\n      };\n    }\n    return {\n      marginBottom: MARGIN_BOTTOM,\n      marginTop: index === 0 ? 40 : undefined\n    };\n  }\n\n  onLayout = event => {\n    const height = event.nativeEvent.layout.height;\n    \n    if (height) {\n      this.setState({firstItemHeight: height});\n    }\n  }\n\n  onItemPress = (index) => {\n    _.invoke(this.props, 'onItemPress', index);\n  }\n\n  renderItem = (item, index) => {\n    const {contentContainerStyle, itemBorderRadius} = this.props;\n    const {firstItemHeight, collapsed} = this.state;\n\n    return (\n      <Animated.View \n        key={index}\n        onLayout={index === 0 ? this.onLayout : undefined}\n        style={[\n          Constants.isIOS && this.styles.containerShadow,\n          this.getStyle(index),\n          {\n            borderRadius: Constants.isIOS ? itemBorderRadius : undefined,\n            alignSelf: 'center',\n            zIndex: this.itemsCount - index,\n            transform: [\n              {scaleX: this.animatedScaleArray[index]}\n            ],\n            width: Constants.screenWidth - 40,\n            height: collapsed ? firstItemHeight : undefined\n          }\n        ]}\n        collapsable={false}\n      >\n        <Card\n          style={[contentContainerStyle, this.styles.card]}\n          onPress={() => this.onItemPress(index)}\n          borderRadius={itemBorderRadius}\n          elevation={5}\n        >\n          <Animated.View style={index !== 0 ? {opacity: this.animatedContentOpacity} : undefined} collapsable={false}>\n            {item}\n          </Animated.View>\n        </Card>\n      </Animated.View>\n    );\n  }\n\n  render() {\n    const {children, containerStyle, buttonProps} = this.props;\n    const {collapsed, firstItemHeight} = this.state;\n\n    return (\n      <View style={containerStyle}>\n        <View style={{marginBottom: PEEP * 3}}>\n          <Animated.View \n            style={{\n              position: 'absolute',\n              right: 0,\n              opacity: this.animatedOpacity,\n              transform: [\n                {scale: this.animatedScale}\n              ]\n            }}\n          >\n            <Button \n              label={'Show less'} \n              iconSource={icon}\n              link\n              size={'small'} \n              {...buttonProps}\n              marginH-24 \n              marginB-20\n              onPress={this.close}\n            />\n          </Animated.View>\n\n          {React.Children.map(children, (item, index) => {\n            return this.renderItem(item, index);\n          })}\n\n          {collapsed && \n            <TouchableOpacity \n              onPress={this.open} \n              activeOpacity={1} \n              style={[\n                this.styles.touchable, \n                {\n                  height: firstItemHeight ? firstItemHeight + (PEEP * 2) : undefined,\n                  zIndex: this.itemsCount\n                }\n              ]}\n            />\n          }\n        </View>\n      </View>\n    );\n  }\n}\n\nfunction createStyles() {\n  return StyleSheet.create({\n    touchable: {\n      position: 'absolute', \n      width: '100%'\n    },\n    containerShadow: {\n      backgroundColor: Colors.white,\n      shadowColor: Colors.dark40,\n      shadowOpacity: 0.25,\n      shadowRadius: 12,\n      shadowOffset: {height: 5, width: 0}\n    },\n    card: {\n      overflow: 'hidden', \n      flexShrink: 1\n    }\n  });\n}\n"]},"metadata":{},"sourceType":"script"}